<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.tailwindcss.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self'; connect-src 'self' https://api.ipify.org;">
    <title>Lineage One - Dashboard</title>
    <!-- Maintenance Mode Check - MUST be the first script -->
    <script src="maintenance.js"></script>

    <!-- Favicon -->
    <link id="favicon-ico" rel="icon" type="image/x-icon" href="icon/cs.ico" />
    <link id="favicon-shortcut" rel="shortcut icon" href="icon/cs.ico" />

    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Font: Cinzel for a classic fantasy look -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">
    <style>
        html {
            overflow-y: scroll; /* Force scrollbar to prevent layout shift */
        }
        body {
            background-color: #000;
            font-family: 'Cinzel', serif;
        }
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-image: var(--dashboard-bg-image);
            background-size: cover;
            background-position: center;
            background-attachment: fixed; /* This is the key property */
            z-index: -1;
            opacity: 0.8; /* Optional: you can adjust the background brightness */
        }
        #dashboard-content {
            opacity: 0; /* Start hidden */
            transition: opacity 1s ease-in-out; /* Smooth fade-in effect */
        }
        .text-shadow {
            text-shadow: 0px 0px 8px rgba(0, 0, 0, 0.9);
        }
        .stat-item {
            border-bottom: 1px solid #3a2d20;
            padding-bottom: 0.5rem;
            margin-bottom: 0.5rem;
        }
        .stat-item:last-child {
            border-bottom: none;
        }
        .equip-slot {
            background-color: rgba(0, 0, 0, 0.3);
            border: 1px solid #4a3a2a;
            padding: 0.75rem;
            border-radius: 0.25rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .storage-item {
            background-color: rgba(0, 0, 0, 0.2);
            border-left: 3px solid #6b7280;
            padding: 0.5rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        .character-slot {
            background-color: rgba(10, 10, 20, 0.75);
            border: none; /* Removed border for a cleaner glass look */
            box-shadow: 0 0 15px rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(3px);
            min-height: 200px;
            position: relative; /* Required for the ::before pseudo-element */
            overflow: hidden;   /* Clips the flowing effect */
        }
        .character-slot::before {
            content: '';
            position: absolute;
            top: 0;
            left: -150%;
            width: 75%;
            height: 100%;
            background: linear-gradient(to right, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.15) 50%, rgba(255, 255, 255, 0) 100%);
            transform: skewX(-25deg);
            animation: flow-shine 5s infinite linear;
        }

        @keyframes flow-shine {
            from { left: -150%; }
            to   { left: 150%; }
        }
        /* Remove border specifically from the logout modal for a cleaner glass look */
        #logout-modal-content {
            border: none;
        }

    </style>
</head>
<body class="text-gray-200 min-h-screen flex items-center justify-center p-4">
    <div id="dashboard-content" class="p-8 rounded-lg text-center max-w-6xl w-full">
        <h1 class="text-4xl font-bold text-yellow-400 mb-2 tracking-wider text-shadow">Welcome, <span id="dashboard-username">Player</span>!</h1>
        
        <!-- Character Select View -->
        <div id="character-select-view">
            <p id="dashboard-subtitle" class="text-gray-400 mb-6 text-shadow">Select a character to begin.</p>
            <div id="character-slots-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8">
                <!-- Character slots will be dynamically generated here -->
            </div>
        </div>

        <!-- Character Detail View (Initially Hidden) -->
        <div id="character-detail-view" class="hidden">
            <div class="flex justify-start gap-4">
                <button id="back-to-select-btn-2" class="bg-gray-600 px-8 py-2 rounded-lg hover:bg-gray-700 transition">Back</button>
                <a href="marketplace.html" class="bg-orange-600 px-8 py-2 rounded-lg hover:bg-orange-700 transition">Go to Marketplace</a>
            </div>
            <div id="character-display" class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-6 text-left">
                <!-- Status and Equipment panels are rendered here -->
            </div>
            <div id="character-storage-panel" class="mt-8 text-left"></div>
        </div>

        <div class="flex justify-center items-center gap-4 mt-8 text-shadow">
            <a href="index.html" class="bg-blue-600 px-8 py-2 rounded-lg hover:bg-blue-700 transition">Back to Main</a>
            <a id="logout-btn" href="index.html" class="bg-red-800/80 border border-red-600 text-red-200 px-8 py-2 rounded-md hover:bg-red-700/80 hover:text-white transition-all duration-300">Logout</a>
            <button id="delete-account-btn" class="text-sm text-red-500 hover:text-red-400 hover:underline">Delete Account</button>
        </div>

    </div>
    
    <!-- ========================================================================
    LOGOUT CONFIRMATION MODAL
    ======================================================================== -->
    <div id="logout-modal" class="modal fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
        <div id="logout-modal-content" class="character-slot p-8 rounded-lg text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
            <h2 class="text-2xl font-bold text-yellow-400 mb-4 text-shadow">Confirm Logout</h2>
            <p class="text-gray-300 mb-6">Are you sure you want to end your session?</p>
            <div class="flex justify-center gap-4">
                <button id="logout-confirm-btn" class="bg-red-800/80 border border-red-600 text-red-200 px-8 py-2 rounded-md hover:bg-red-700/80 hover:text-white transition-all duration-300">Logout</button>
                <button id="logout-cancel-btn" class="bg-gray-600 px-8 py-2 rounded-lg hover:bg-gray-700 transition">Cancel</button>
            </div>
        </div>
    </div>

    <!-- ========================================================================
    GENERIC CONFIRMATION MODAL (for Deletion, etc.)
    ======================================================================== -->
    <div id="confirm-modal" class="modal fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
        <div id="confirm-modal-content" class="character-slot p-8 rounded-lg text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
            <h2 id="confirm-modal-title" class="text-2xl font-bold text-yellow-400 mb-4 text-shadow">Confirm Action</h2>
            <p id="confirm-modal-message" class="text-gray-300 mb-6">Are you sure?</p>
            <!-- Type-to-confirm input section (hidden by default) -->
            <div id="confirm-input-container" class="my-4 hidden">
                <label id="confirm-input-label" for="confirm-input" class="text-sm text-gray-400 block mb-2">To confirm, please type the text below:</label>
                <p id="confirm-input-text" class="font-bold text-lg text-yellow-300 tracking-widest mb-2"></p>
                <input type="text" id="confirm-input" class="w-full bg-gray-900/50 border border-gray-600 rounded-md p-2 text-center text-white" autocomplete="off">
            </div>
            <div class="flex justify-center gap-4">
                <button id="confirm-modal-confirm-btn" class="bg-red-800/80 border border-red-600 text-red-200 px-8 py-2 rounded-md hover:bg-red-700/80 hover:text-white transition-all duration-300">Confirm</button>
                <button id="confirm-modal-cancel-btn" class="bg-gray-600 px-8 py-2 rounded-lg hover:bg-gray-700 transition">Cancel</button>
            </div>
        </div>
    </div>

    <!-- ========================================================================
    GENERIC INFO MODAL (for simple notifications)
    ======================================================================== -->
    <div id="info-modal" class="modal fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
        <div id="info-modal-content" class="character-slot p-8 rounded-lg text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
            <h2 id="info-modal-title" class="text-2xl font-bold text-yellow-400 mb-4 text-shadow">Notice</h2>
            <p id="info-modal-message" class="text-gray-300 mb-6">This is an informational message.</p>
            <div class="flex justify-center">
                <button id="info-modal-ok-btn" class="bg-blue-600 px-8 py-2 rounded-lg hover:bg-blue-700 transition">OK</button>
            </div>
        </div>
    </div>

    <!-- ========================================================================
    DELETE ACCOUNT CONFIRMATION MODAL
    ======================================================================== -->
    <div id="delete-account-modal" class="modal fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
        <div id="delete-account-modal-content" class="character-slot p-8 rounded-lg text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
            <h2 id="delete-account-modal-title" class="text-2xl font-bold text-red-500 mb-4 text-shadow">DELETE ACCOUNT</h2>
            <p id="delete-account-modal-message" class="text-gray-300 mb-6">Message here.</p>
            <!-- Type-to-confirm input section -->
            <div id="delete-account-input-container" class="my-4">
                <label for="delete-account-input" class="text-sm text-gray-400 block mb-2">To confirm, please type the text below:</label>
                <p id="delete-account-input-text" class="font-bold text-lg text-yellow-300 tracking-widest mb-2"></p>
                <input type="text" id="delete-account-input" class="w-full bg-gray-900/50 border border-gray-600 rounded-md p-2 text-center text-white" autocomplete="off">
            </div>
            <div class="flex justify-center gap-4">
                <button id="delete-account-confirm-btn" class="bg-red-800/80 border border-red-600 text-red-200 px-8 py-2 rounded-md hover:bg-red-700/80 hover:text-white transition-all duration-300" disabled>Confirm</button>
                <button id="delete-account-cancel-btn" class="bg-gray-600 px-8 py-2 rounded-lg hover:bg-gray-700 transition">Cancel</button>
            </div>
        </div>
    </div>
    <script src="modal.js"></script>
    <script src="dashboard.js"></script>
</body>
</html>