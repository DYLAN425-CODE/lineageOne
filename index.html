<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-inline' 'unsafe-eval' https://cdn.tailwindcss.com https://www.gstatic.com; style-src 'self' 'unsafe-inline' https://fonts.googleapis.com; font-src 'self' https://fonts.gstatic.com; img-src 'self'; media-src 'self' blob:; connect-src 'self' https://timeapi.io https://api.ipify.org; object-src 'none'; frame-src 'none'; base-uri 'self'; form-action 'self';">
  <title>Lineage</title>

  <!-- Maintenance Mode Check - MUST be the first script -->
  <script src="maintenance.js"></script>

  <!-- Favicon -->
  <link id="favicon-ico" rel="icon" type="image/x-icon" href="icon/cs.ico" />
  <link id="favicon-shortcut" rel="shortcut icon" href="icon/cs.ico" />

  <!-- Google Font: Cinzel for a classic fantasy look -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@400;700&display=swap" rel="stylesheet">

  <!-- Tailwind CSS CDN -->
  <script src="https://cdn.tailwindcss.com"></script>

  <!-- External CSS -->
  <link rel="stylesheet" href="style.css" />

  <!-- Firebase SDK -->
  <!-- Updated Firebase SDKs (v9+ with compat libraries) -->
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/10.5.2/firebase-firestore-compat.js"></script>

</head>
<body class="bg-gradient-to-br from-gray-900 to-black min-h-screen text-gray-200 text-base md:text-lg px-4 md:px-8 overflow-x-hidden">

  <!-- ========================================================================
  SEAMLESS BACKGROUND VIDEO
  ======================================================================== -->
  <div id="bg-video-container">
    <video src="media/lineage3.mp4" autoplay muted playsinline preload="metadata" style="opacity: 1;"></video>
  </div>

  <!-- ========================================================================
  MAIN CONTENT
  ======================================================================== -->
  <div id="main-content" class="max-w-7xl mx-auto hidden">

    <!-- ========================================================================
    HEADER
    ======================================================================== -->
    <header class="text-center py-10 fade-in">
      <a href="index.html">
        <img src="images/logo-lineage.png" alt="Lineage One" class="mx-auto h-auto w-full max-w-md" />
      </a>

      <!-- Server Status Indicator -->
      <div id="server-status" class="mt-4 text-lg">
        <span class="status-dot"></span>
        <span id="status-text">Checking...</span>
      </div>
     
      <div class="mt-6 flex flex-wrap justify-center gap-4">
        <a href="login.html" id="login-button" class="action-btn btn-blue">Login</a>
        <a href="register.html" class="action-btn btn-green">Register</a>
        <button id="logout-button" class="action-btn btn-red hidden">Logout</button>
        <button id="droplist-button" class="action-btn btn-yellow">Drop List</button>
        <button id="marketplace-button" class="action-btn btn-orange">Marketplace</button>
        <button id="item-viewer-button" class="action-btn btn-green">Item Viewer</button>
        <button id="download-button-header" class="action-btn btn-purple">Download</button>
        <button id="discord-button" class="action-btn btn-indigo">Join Discord</button>
      </div>
    </header>

    <!-- ========================================================================
    COUNTDOWN TIMER
    ======================================================================== -->
    <section id="countdown" class="text-center py-6 fade-in">
      <h2 class="cinematic-title cinematic-title-red text-2xl font-semibold"> Server Launch In:</h2>
      <p class="text-3xl font-bold text-yellow-400 mt-2" id="timer">Loading...</p>
    </section>

    <!-- ========================================================================
    NEWS & ANNOUNCEMENTS
    ======================================================================== -->
    <section id="news" class="max-w-3xl mx-auto py-6 fade-in">
      <h2 class="cinematic-title cinematic-title-red text-2xl font-semibold text-center mb-6">Latest News & Announcements</h2>
      <div id="news-container" class="space-y-6">
        <!-- News items will be loaded here by script.js -->
        <p class="text-center text-gray-400">Loading news...</p>
      </div>
    </section>

    <!-- ========================================================================
    DOWNLOAD
    ======================================================================== -->
    <section id="download" class="text-center py-10 fade-in hidden">
      <h2 class="cinematic-title cinematic-title-red text-2xl font-semibold mb-4">‚¨áÔ∏è Download Game Client</h2>
      <a href="downloads/L1P8.1.zip" id="download-btn" class="action-btn btn-purple">
        <span class="btn-text">Download Now</span>
      </a>
    </section>

    <!-- ========================================================================
    DISCORD
    ======================================================================== -->
    <section id="discord" class="text-center py-10 fade-in hidden">
      <h2 class="text-2xl font-bold mb-4">üí¨ Join our Discord Community</h2>
      <p class="text-gray-300 mb-4">Get support, updates, and chat with fellow players.</p>
      <a href="https://discord.gg/SH8unyQRf7" target="_blank" rel="noopener noreferrer" class="action-btn btn-indigo">Join Discord</a>
    </section>

    <!-- ========================================================================
    CHARACTER CREATION FORM
    ======================================================================== -->
    <section id="characterCreationForm" class="ui-panel max-w-md mx-auto py-10 fade-in hidden" aria-labelledby="char-create-heading">
      <div id="character-creation-message" role="alert" class="text-center mb-4"></div>
      <form id="character-creation-form">
        <fieldset class="space-y-4">
          <legend id="char-create-heading" class="text-2xl font-bold mb-4 text-center">Create Your Character</legend>
        <div class="form-group">
          <input type="text" id="charname" name="charname" placeholder=" " required class="form-input" />
          <label for="charname" class="form-label">‚ú® Character Name</label>
          <div id="charname-error" class="text-sm mt-1" aria-live="polite"></div>
        </div>
        
        <!-- Gender Selection -->
        <fieldset class="pt-2">
          <legend class="font-bold text-lg mb-2 block text-center">Gender</legend>
          <div class="gender-select-container">
            <input type="radio" id="gender-male" name="gender" value="Male" checked>
            <label for="gender-male" class="gender-select-label">Male</label>
            <input type="radio" id="gender-female" name="gender" value="Female">
            <label for="gender-female" class="gender-select-label">Female</label>
          </div>
        </fieldset>

        <!-- Class Selection -->
        <fieldset class="pt-2">
          <legend class="font-bold text-lg mb-2 block text-center">Class</legend>
          <div id="class-selection-grid" class="grid grid-cols-2 sm:grid-cols-3 gap-3">
            <!-- Class cards will be generated by JS -->
          </div>
          <!-- Hidden select for form submission -->
          <select name="class" id="class-select" required class="hidden">
             <!-- Options will be generated by JS -->
          </select>
        </fieldset>

        <div class="flex gap-4 mt-4">
          <button type="button" id="create-char-back-btn" class="w-full action-btn btn-gray text-center">Back</button>
          <button type="submit" class="w-full action-btn btn-green">Create Character</button>
        </div>
        </fieldset>
      </form>
    </section>

    <!-- ========================================================================
    DASHBOARD
    ======================================================================== -->
    <section id="dashboard" class="p-8 rounded-lg text-center max-w-6xl w-full mx-auto hidden">
        <h1 class="text-4xl font-bold text-yellow-400 mb-2 tracking-wider text-shadow">Welcome, <span id="dashboard-username">Player</span>!</h1>
        
        <!-- Character Select View -->
        <div id="character-select-view">
            <p id="dashboard-subtitle" class="text-gray-400 mb-6 text-shadow">Select a character to begin.</p>
            <div id="character-slots-container" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mt-8">
                <!-- Character slots will be dynamically generated here -->
            </div>
        </div>

        <!-- Character Detail View (Initially Hidden) -->
        <div id="character-detail-view" class="hidden">
            <div class="flex justify-start gap-4">
                <button id="back-to-select-btn-2" class="action-btn btn-gray">Back</button>
                <button id="go-to-market-btn" class="action-btn btn-orange">Go to Marketplace</button>
            </div>
            <div id="character-display" class="grid grid-cols-1 md:grid-cols-2 gap-8 mt-6 text-left">
                <!-- Status and Equipment panels are rendered here -->
            </div>
            <div id="character-storage-panel" class="mt-8 text-left"></div>
        </div>

        <div class="flex justify-center items-center gap-4 mt-8 text-shadow">
            <button id="delete-account-btn" class="text-sm text-red-500 hover:text-red-400 hover:underline">Delete Account</button>
        </div>
    </section>

    <!-- ========================================================================
    LORE
    ======================================================================== -->
    <section id="lore" class="text-center px-4 py-10 text-gray-300 text-sm md:text-base fade-in">
      <h2 class="text-xl font-semibold mb-2">A legend in online gaming:</h2>
      <h2 class="text-4xl font-bold mb-6">Lineage</h2>
      <p class="max-w-3xl mx-auto leading-relaxed">Released in 1998, Lineage, an MMORPG set in a medieval fantasy world, was the first Internet-base online game in Korea. The first single game to archieve KRW 1 trillion in cumulative sales by 2008, it laid the ground for future MMORPGs with elements such as guilds and Castle Siege. Twenty years later, it is still an influential phenomenon in the world of online cultural content representative of Korea.</p>
    </section>

    <!-- ========================================================================
    IMAGE GALLERY
    ======================================================================== -->
    <section id="gallery" class="max-w-5xl mx-auto py-10 fade-in">
      <h2 class="text-3xl font-bold text-center mb-8">Gallery</h2>
      <div id="gallery-grid" class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4">
        <div class="gallery-item"><video src="gallery/intro.mp4" loop muted playsinline preload="metadata" class="w-full h-full object-cover"></video></div>
        <div class="gallery-item"><img src="gallery/2.jpg" alt="" loading="lazy"></div>
        <div class="gallery-item"><img src="gallery/3.jpg" alt="" loading="lazy"></div>
        <div class="gallery-item"><img src="gallery/4.jpg" alt="" loading="lazy"></div>
        <div class="gallery-item"><img src="gallery/5.jpg" alt="" loading="lazy"></div>
        <div class="gallery-item"><img src="gallery/6.jpg" alt="" loading="lazy"></div>
        <div class="gallery-item"><img src="gallery/7.jpg" alt="" loading="lazy"></div>
        <div class="gallery-item"><img src="gallery/8.jpg" alt="" loading="lazy"></div>
      </div>
    </section>

    <!-- ========================================================================
    FOOTER
    ======================================================================== -->
    <footer class="text-center py-6 text-sm text-gray-400 space-y-4">
      <div id="footer-text-container">&copy; 2025 Lineage 1 Server. All rights reserved.</div>
      <div id="social-links-container" class="flex justify-center gap-6">
        <a href="#" id="social-facebook" class="hidden social-link" target="_blank" rel="noopener noreferrer" title="Facebook">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M9 8h-3v4h3v12h5v-12h3.642l.358-4h-4v-1.667c0-.955.192-1.333 1.115-1.333h2.885v-5h-3.808c-3.596 0-5.192 1.583-5.192 4.615v3.385z"/></svg>
        </a>
        <a href="#" id="social-youtube" class="hidden social-link" target="_blank" rel="noopener noreferrer" title="YouTube">
          <svg class="w-6 h-6" fill="currentColor" viewBox="0 0 24 24"><path d="M19.615 3.184c-3.604-.246-11.631-.245-15.23 0-3.897.266-4.356 2.62-4.385 8.816.029 6.185.484 8.549 4.385 8.816 3.6.245 11.626.246 15.23 0 3.897-.266 4.356-2.62 4.385-8.816-.029-6.185-.484-8.549-4.385-8.816zm-10.615 12.816v-8l8 3.993-8 4.007z"/></svg>
        </a>
      </div>
    </footer>

  </div>

  <!-- ========================================================================
  MODALS (Placed outside main-content to prevent visibility issues)
  ======================================================================== -->

  <!-- IMAGE LIGHTBOX/MODAL -->
  <div id="lightbox" class="fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
    <img id="lightbox-img" src="" alt="Enlarged gallery image" class="max-w-full max-h-full object-contain rounded-lg shadow-2xl transition-transform duration-300 scale-95">
    <!-- Lightbox Navigation -->
    <button id="lightbox-prev" class="lightbox-nav-btn left-4">&lt;</button>
    <button id="lightbox-next" class="lightbox-nav-btn right-4">&gt;</button>
    <button id="lightbox-close" class="absolute top-4 right-6 text-white text-5xl font-bold opacity-70 hover:opacity-100 transition-opacity">&times;</button>
  </div>

  <!-- GENERIC SUCCESS MODAL -->
  <div id="success-modal" class="fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
      <div id="success-modal-content" class="ui-panel p-8 text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
          <h2 id="success-modal-title" class="text-2xl font-bold text-green-400 mb-4">Success!</h2>
          <p id="success-modal-message" class="text-gray-300 mb-6">Operation completed successfully.</p>
          <div class="flex justify-center gap-4">
              <button id="success-modal-ok-btn" class="action-btn btn-green">OK</button>
          </div>
      </div>
  </div>

  <!-- GENERIC INFO/WARNING MODAL -->
  <div id="info-modal" class="fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
      <div id="info-modal-content" class="ui-panel p-8 text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
          <h2 id="info-modal-title" class="text-2xl font-bold text-yellow-400 mb-4">Notice</h2>
          <p id="info-modal-message" class="text-gray-300 mb-6">This is an informational message.</p>
          <div class="flex justify-center gap-4">
              <button id="info-modal-ok-btn" class="action-btn btn-blue">OK</button>
          </div>
      </div>
  </div>

  <!-- DEDICATED NOTIFICATION MODAL (for specific messages) -->
  <div id="notification-modal" class="fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
      <div id="notification-modal-content" class="ui-panel p-8 text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
          <h2 id="notification-modal-title" class="text-2xl font-bold text-yellow-400 mb-4">Notice</h2>
          <p id="notification-modal-message" class="text-gray-300 mb-6">This is a notification.</p>
          <div class="flex justify-center gap-4">
              <button id="notification-modal-ok-btn" class="action-btn btn-blue">OK</button>
          </div>
      </div>
  </div>

  <!-- GENERIC CONFIRMATION MODAL -->
  <div id="confirm-modal" class="fixed inset-0 modal-overlay-pattern flex items-center justify-center p-4 z-50 hidden opacity-0 transition-opacity duration-300">
      <div id="confirm-modal-content" class="ui-panel p-8 text-center max-w-sm w-full transform scale-95 transition-transform duration-300">
          <h2 id="confirm-modal-title" class="text-2xl font-bold text-yellow-400 mb-4">Are you sure?</h2>
          <p id="confirm-modal-message" class="text-gray-300 mb-6">This action cannot be undone.</p>
          <div class="flex justify-center gap-4">
              <button id="confirm-modal-cancel-btn" class="action-btn btn-gray">Cancel</button>
              <button id="confirm-modal-ok-btn" class="action-btn btn-red">Confirm</button>
          </div>
      </div>
  </div>

  <!-- ========================================================================
  SCRIPT INCLUDES
  ======================================================================== -->
  <script type="module" src="firebase-config.js"></script>
  <script type="module" src="modal.js"></script>
  <script type="module" src="item-viewer.js"></script>
  <script type="module" src="droplist.js"></script>
  <script type="module" src="dashboard.js"></script>
  <script type="module" src="create-character.js"></script>
  <!-- login.js is now only on login.html -->
  <!-- register.js is now only on register.html -->
  <!-- marketplace.js is now only on marketplace.html -->
  <!-- droplist-table.js is not a file in the context -->
  <!-- debug.js is not a file in the context -->
  <script type="module" src="script.js"></script>

</body>
</html>
